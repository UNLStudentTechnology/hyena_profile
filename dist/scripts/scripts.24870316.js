"use strict";angular.module("hyenaProfileApp",["ngAnimate","ngCookies","ngResource","ngSanitize","ngTouch","ui.router","hyenaAngular","ngFileUpload"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(a,b,c){a.state("unl-layout",{templateUrl:"views/layouts/unl-layout.html",data:{requireAuth:!0}}).state("unl-layout-kiosk",{templateUrl:"views/layouts/unl-layout-kiosk.html",data:{requireAuth:!0}}).state("unl-layout-kiosk.main",{url:"/:groupId",templateUrl:"views/main.html",controller:"MainCtrl"}),b.otherwise("/"),c.html5Mode(!0)}]).config(["$httpProvider",function(a){a.interceptors.push(["$injector",function(a){return a.get("AuthInterceptor")}])}]).constant("FBURL","https://hyena-profile.firebaseio.com/").constant("APIKEY","ZTM1ODE3ZDhhZTEyYzQxMGVjN2RiZDA0").constant("APIPATH","http://st-studio.unl.edu/hyena_platform/public/api/1.0/").constant("PLATFORM_ROOT","http://st-studio.unl.edu/hyena_platform/public/").constant("AUTH_SCOPE","groups"),angular.module("hyenaProfileApp").controller("MainCtrl",["$scope","$rootScope","$stateParams","FirebaseGroupService","UserService","AuthService","ReservationService","Notification",function(a,b,c,d,e,f,g,h){a.selectedTab=0;var i=c.groupId;a.groupId=b.currentGroupId=i,angular.isDefined(i)&&""!==i&&d.existsOrAdd(i),a.$watch("currentUser",function(b,c){angular.isDefined(c)&&null!==b&&b!==c&&a.profileSettings.$valid&&a.updateUser()},!0),a.updateUser=function(){e.update(a.currentUser.uni_auth,a.currentUser).then(function(){},function(a){h.show(a.message,"error")})};var j=g.user(f.userId()).$asObject();j.$bindTo(a,"availabilityUser"),j.$loaded().then(function(){var b=g.schedule(f.userId()).$asObject();b.$bindTo(a,"schedule")}),a.uploadImage=function(b){console.log(b[0]),e.uploadImage(f.userId(),b[0]).progress(function(a){console.log("progress: "+parseInt(100*a.loaded/a.total)+"% file :"+a.config.file.name)}).success(function(b){a.currentUser.profile_image=b.uploaded_file}).error(function(a){h.show("Sorry! There was an error uploading that image.","error"),console.log("Icon upload failed:",a)})}}]);